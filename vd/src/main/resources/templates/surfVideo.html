<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="/css/surfVideo.css"/>   
<script src="https://unpkg.com/vuex"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script> 
<script src="/vue/surfVideoVue.js"></script>
<script src="/vue/surfVideoStore.js"></script>
</head>
<body>   
 <section class="webdesigntuts-workshop" id="surfVideo">
  <form action="" method="">		    
    <input type="search" id="searchText" placeholder="What are you looking for?">		    	
    <button id="search" v-on:click="commitVdNo">Search</button>
  </form>
</section>

 <div id="surfVideoTile">       
   <surfvideo-view></surfvideo-view>    
   
 
 </div>   
</body>
<script>   

  const surfVideoSt = new Vuex.Store(surfVideoStore);
    
   new Vue({
     el: '#surfVideo',  
     store: surfVideoSt, 
     methods: { 
      commitVdNo: function(e){   
        e.preventDefault();
  
        document.getElementById('youtubeVideoList').innerHTML = "";

        let searchInfo = {
          q: document.getElementById('searchText').value
        } 

        fetch('http://localhost:5001/searchYoutubeVD', {
            method: 'post',
            headers: {
            'Content-Type': 'application/json'
            },
            body: JSON.stringify(searchInfo)
            })
            .then(res => res.json())
            .then(function(data) {
              if(data !== null)
              { 
                for(let i =0; i<data.items.length; i++)
                {
                    document.getElementById('youtubeVideoList').innerHTML += '<li><iframe width="560" class="youtubevd" height="315" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></li>  '
                    document.getElementsByClassName('youtubevd')[i].setAttribute("src", surfVideoSt.state.ytubeUrl + data.items[i].id.videoId); 

                    // if(typeof data.items[i].id.videoId !== "undefined")
                  
                 
                }
                // surfVideoSt.commit('commitVdNo', data.items[1].id.videoId);   
                
 
              } 
            })
        
        } 
      }
 
    });  

    new Vue({
     el: '#surfVideoTile', 
     component: 'surfvideo-view',
     store: surfVideoSt, 
     methods: { 
      
    }
 
   });  
 

 </script>
</html>

